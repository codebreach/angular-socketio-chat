"use strict";angular.module("pizzeriaApp",["ngCookies","ngResource","ngSanitize","btford.socket-io"]).value("nickName","anonymous"),angular.module("pizzeriaApp").controller("MainCtrl",["$log","$scope","$http","pizzaSocket",function(a,b,c,d){b.size="small",b.toppings=0,b.pendingPizzas=[],c.get("/api/pizzas").then(function(a){b.pendingPizzas=a.data.pizzas||[]}),b.addPizza=function(){var a={size:b.size,toppings:b.toppings};console.log("adding pizza"),d.emit("addPizza","user",a)},b.getClassFor=function(a){return{active:b.size===a}},b.updateToppings=function(a){b.toppings=a+b.toppings,b.toppings<0&&(b.toppings=0)},b.$on("socket:newPizza",function(c,d){a.debug("got a message",c.name,d),b.pendingPizzas.push(d)}),b.$on("socket:updatePizza",function(c,d){a.debug("got a message",c.name,d);for(var e=0;e<b.pendingPizzas.length;e++)if(b.pendingPizzas[e].id==d.id){b.pendingPizzas[e]=d;break}})}]),angular.module("pizzeriaApp").factory("pizzaSocket",["socketFactory",function(a){var b=a();return b.forward("broadcast"),b.forward("updatePizza"),b.forward("newPizza"),b}]),angular.module("pizzeriaApp").value("messageFormatter",function(a,b,c){return a.toLocaleTimeString()+" - "+b+" - "+c+"\n"});